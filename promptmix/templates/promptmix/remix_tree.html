<!-- promptmix/templates/promptmix/remix_tree.html -->
<!-- Cody Headings, codyh@bu.edu 11/27/25 -->
<!-- Recursive page for displaying many remixes in a chain -->

<div class="remix">
    <strong>
        Re: {{subject}}
    </strong>
    <p class="info">
        <a href="{% url 'show_profile' remix.profile.pk %}">
            {{ remix.profile }}
        </a> 
        | {{ remix.timestamp }}
    </p>

    <p>{{ remix.text }}</p>
    <hr>

    {% if remix.children.all %}
        <div class="children">
            {% for child in remix.children.all|slice:":1" %}
                {% include "promptmix/remix_tree.html" with remix=child subject="Re: "|add:subject%}
            {% endfor %}

            {% if remix.children.all|length > 1 %}
                <div class="show-more" onclick="this.nextElementSibling.style.display='block'; this.style.display='none';">
                    Show {{ remix.children.all|length|add:"-1" }} more remixes...
                </div>

                <div style="display:none;">
                    {% for child in remix.children.all|slice:"1:" %}
                        {% include "promptmix/remix_tree.html" with remix=child subject="Re: "|add:subject%}
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    {% endif %}
</div>