<!-- mini_insta/templates/mini_insta/search.html -->
<!-- Cody Headings, codyh@bu.edu 10/17/25 -->
<!-- html page for results of search form -->

{% extends 'mini_insta/base.html' %}

{% block content %}
<main class="container">
    <h1>Results for “{{ query }}”</h1>

    <section class="search-results">
        <h2>Profiles</h2>
        {% if matches %}
            <div class="grid-container">
                {% for result in matches %}
                    <profile>
                        {% if result.profile_image_url %}
                            <a href="{% url 'show_profile' result.pk %}">
                                <img class="thumbnail" 
                                src="{{result.profile_image_url}}" 
                                alt="{{result.profile_image_url}}">
                            </a>
                        {% endif %}

                        <div>
                            <a href="{% url 'show_profile' result.pk %}">
                                <h2>{{result.display_name}}</h2>
                            </a>
                            <p>@{{result.username}}</p>
                            <div class="grid-container-2">
                                <div>
                                    <h3>Posts:</h3>
                                    <p>{{result.get_post_count}}</p>
                                </div>
                                <div>
                                    <h3>Followers:</h3>
                                    <p>{{result.get_num_followers}}</p>
                                </div>
                                <div>
                                    <h3>Following:</h3>
                                    <p>{{result.get_num_following}}</p>
                                </div>
                            </div>
                        </div>
                    </profile>
                {% endfor %}
            </div>
        {% else %}
            <p>No matching profiles found.</p>
        {% endif %}
    </section>

    <hr>

    <section class="search-results">
        <h2>Posts</h2>
        {% if posts %}
            <div class="grid-container">
                {% for post in posts %}
                    <div class="post-card">
                        {% if post.has_photos %}
                            <a href="{% url 'show_post' post.pk %}">
                                <img src="{{ post.get_all_photos.0.get_image_url }}" alt="Post Image" class="post-thumbnail">
                            </a>
                        {% else %}
                            <a href="{% url 'show_post' post.pk %}">
                                <img src="https://cs-webapps.bu.edu/codyh/media/NoImage.png" alt="No Image" class="post-thumbnail">
                            </a>
                        {% endif %}
                        <p>{{ post.caption|truncatewords:15 }}</p>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No matching posts found.</p>
        {% endif %}
    </section>
</main>
{% endblock %}
